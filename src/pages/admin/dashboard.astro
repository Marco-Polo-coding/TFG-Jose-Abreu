---
import AdminLayout from '../../layouts/AdminLayout.astro';
import AdminDashboard from '../../components/admin/AdminDashboard';

// Indicar que esta p√°gina debe ser renderizada en el servidor
export const prerender = false;

// Verificar si el usuario es administrador usando cookies o localStorage
const userRole = Astro.cookies.get('userRole')?.value;
const isAdmin = userRole === 'admin';

// Si no hay cookie de admin, verificar localStorage en el cliente
if (!isAdmin) {
  // Agregar script para verificar localStorage
  const script = `
    const userRole = localStorage.getItem('userRole');
    if (userRole !== 'admin') {
      window.location.href = '/';
    }
  `;
}
---

<AdminLayout title="Dashboard">
  <script>
    {`
      const userRole = localStorage.getItem('userRole');
      if (userRole !== 'admin') {
        window.location.href = '/';
      }
    `}
  </script>
  <AdminDashboard client:load />
</AdminLayout> 