---
import AdminLayout from '../../layouts/AdminLayout.astro';
import AdminDashboard from '../../components/admin/AdminDashboard';

// Indicar que esta página debe ser renderizada en el servidor
export const prerender = false;

// Verificar si el usuario es administrador usando solo cookies
const userRole = Astro.cookies.get('userRole')?.value;
const isAdmin = userRole === 'admin';

// Debug para entender qué está pasando
console.log('Dashboard - userRole cookie:', userRole);
console.log('Dashboard - isAdmin:', isAdmin);

// Si no es admin, redirigir al inicio
if (!isAdmin) {
  console.log('Dashboard - No es admin, redirigiendo al inicio');
  return Astro.redirect('/');
}
---

<AdminLayout title="Dashboard">
  <AdminDashboard client:load />
</AdminLayout>